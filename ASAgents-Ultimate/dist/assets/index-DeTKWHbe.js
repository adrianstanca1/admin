import{r as e,a as t,g as s}from"./vendor-I-qLDgBd.js";import{r as n,T as r,R as a,H as i,C as o,B as c,a as l}from"./ui-CK97iYiv.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var d,h,m={exports:{}},u={};var g,p=(h||(h=1,m.exports=function(){if(d)return u;d=1;var t=e(),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,n){var o,c={},l=null,d=null;for(o in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,o)&&!i.hasOwnProperty(o)&&(c[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===c[o]&&(c[o]=t[o]);return{$$typeof:s,type:e,key:l,ref:d,props:c,_owner:a.current}}return u.Fragment=n,u.jsx=o,u.jsxs=o,u}()),m.exports),x={};const f=s(function(){if(g)return x;g=1;var e=t();return x.createRoot=e.createRoot,x.hydrateRoot=e.hydrateRoot,x}());var y=(e=>(e.OWNER="OWNER",e.ADMIN="ADMIN",e.PROJECT_MANAGER="PROJECT_MANAGER",e.FOREMAN="FOREMAN",e.OPERATIVE="OPERATIVE",e.CLIENT="CLIENT",e.PRINCIPAL_ADMIN="PRINCIPAL_ADMIN",e))(y||{}),w=(e=>(e.VIEW_ALL_PROJECTS="VIEW_ALL_PROJECTS",e.VIEW_ASSIGNED_PROJECTS="VIEW_ASSIGNED_PROJECTS",e.CREATE_PROJECT="CREATE_PROJECT",e.MANAGE_PROJECT_DETAILS="MANAGE_PROJECT_DETAILS",e.MANAGE_PROJECT_TEMPLATES="MANAGE_PROJECT_TEMPLATES",e.MANAGE_PROJECTS="MANAGE_PROJECTS",e.VIEW_ALL_TASKS="VIEW_ALL_TASKS",e.MANAGE_TASKS="MANAGE_TASKS",e.MANAGE_ALL_TASKS="MANAGE_ALL_TASKS",e.SUBMIT_TIMESHEET="SUBMIT_TIMESHEET",e.VIEW_ALL_TIMESHEETS="VIEW_ALL_TIMESHEETS",e.MANAGE_TIMESHEETS="MANAGE_TIMESHEETS",e.UPLOAD_DOCUMENTS="UPLOAD_DOCUMENTS",e.VIEW_DOCUMENTS="VIEW_DOCUMENTS",e.VIEW_DASHBOARD="VIEW_DASHBOARD",e.EDIT_PROJECTS="EDIT_PROJECTS",e.SUBMIT_SAFETY_REPORT="SUBMIT_SAFETY_REPORT",e.VIEW_SAFETY_REPORTS="VIEW_SAFETY_REPORTS",e.MANAGE_SAFETY_REPORTS="MANAGE_SAFETY_REPORTS",e.VIEW_FINANCES="VIEW_FINANCES",e.MANAGE_FINANCES="MANAGE_FINANCES",e.VIEW_TEAM="VIEW_TEAM",e.MANAGE_TEAM="MANAGE_TEAM",e.MANAGE_EQUIPMENT="MANAGE_EQUIPMENT",e.VIEW_AUDIT_LOG="VIEW_AUDIT_LOG",e.SEND_DIRECT_MESSAGE="SEND_DIRECT_MESSAGE",e.ACCESS_ALL_TOOLS="ACCESS_ALL_TOOLS",e.SUBMIT_EXPENSE="SUBMIT_EXPENSE",e))(w||{});const v={OWNER:new Set(Object.values(w)),ADMIN:new Set(["VIEW_ALL_PROJECTS","CREATE_PROJECT","MANAGE_PROJECT_DETAILS","VIEW_ALL_TASKS","MANAGE_ALL_TASKS","VIEW_ALL_TIMESHEETS","MANAGE_TIMESHEETS","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","VIEW_SAFETY_REPORTS","MANAGE_SAFETY_REPORTS","VIEW_FINANCES","MANAGE_FINANCES","VIEW_TEAM","MANAGE_TEAM","MANAGE_EQUIPMENT","VIEW_AUDIT_LOG","SEND_DIRECT_MESSAGE","ACCESS_ALL_TOOLS","SUBMIT_EXPENSE","MANAGE_PROJECT_TEMPLATES"]),PROJECT_MANAGER:new Set(["VIEW_ALL_PROJECTS","MANAGE_PROJECT_DETAILS","VIEW_ALL_TASKS","MANAGE_ALL_TASKS","VIEW_ALL_TIMESHEETS","MANAGE_TIMESHEETS","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","VIEW_SAFETY_REPORTS","VIEW_FINANCES","VIEW_TEAM","MANAGE_EQUIPMENT","SEND_DIRECT_MESSAGE","SUBMIT_EXPENSE"]),FOREMAN:new Set(["VIEW_ASSIGNED_PROJECTS","SUBMIT_TIMESHEET","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","SUBMIT_SAFETY_REPORT","VIEW_SAFETY_REPORTS","SEND_DIRECT_MESSAGE","SUBMIT_EXPENSE"]),OPERATIVE:new Set(["VIEW_ASSIGNED_PROJECTS","SUBMIT_TIMESHEET","VIEW_DOCUMENTS","SUBMIT_SAFETY_REPORT","SUBMIT_EXPENSE"]),CLIENT:new Set(["VIEW_ASSIGNED_PROJECTS","VIEW_DOCUMENTS"]),PRINCIPAL_ADMIN:new Set(Object.values(w))},b=new Set,E=(e=100)=>new Promise(t=>setTimeout(t,e)),j={id:"1",name:"Demo Construction Co",type:"GENERAL_CONTRACTOR",address:{street:"123 Main St",city:"Demo City",state:"Demo State",zipCode:"12345",country:"United States"},phone:"555-0123",email:"info@democonstruction.com",website:"https://democonstruction.com",licenseNumber:"LIC123456",insuranceInfo:{provider:"Demo Insurance",policyNumber:"POL123456",expiryDate:"2025-12-31"},isActive:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),settings:{timeZone:"America/New_York",dateFormat:"MM/DD/YYYY",currency:"USD",theme:"light",accessibility:{highContrast:!1},features:{projectManagement:!0,reporting:!0,timeTracking:!0,financials:!0,documents:!0,safety:!0,equipment:!0},workingHours:{start:"08:00",end:"17:00",workDays:[1,2,3,4,5]}},plan:"FREE",status:"Active",storageUsageGB:0},N=(e,t="Demo",s="User")=>({id:Date.now().toString(),firstName:t,lastName:s,email:e,role:y.OWNER,permissions:[w.VIEW_DASHBOARD,w.EDIT_PROJECTS],companyId:j.id,isActive:!0,isEmailVerified:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),preferences:{theme:"light",language:"en",notifications:{},dashboard:{}}}),S=async e=>{if(await E(),!e.email||!e.password)throw new Error("Email and password are required");return{success:!0,user:N(e.email),company:j,availableCompanies:[{id:j.id,name:j.name,role:y.OWNER}],activeCompanyId:j.id,token:"mock-jwt-token",refreshToken:"mock-refresh-token",mfaRequired:!1}},k=async e=>{if(await E(),!e.email||!e.password)throw new Error("Email and password are required");if(b.has(e.email))throw new Error("Email already exists");b.add(e.email);return{success:!0,user:N(e.email,e.firstName,e.lastName),company:j,availableCompanies:[{id:j.id,name:j.name,status:"Active",role:y.OWNER}],activeCompanyId:j.id,token:"mock-jwt-token",refreshToken:"mock-refresh-token"}},A=async(e,t)=>{if(await E(),!t.email)throw new Error("Email is required for social login");return{success:!0,user:N(t.email,t.firstName,t.lastName),company:j,availableCompanies:[{id:j.id,name:j.name,status:"Active",role:y.OWNER}],activeCompanyId:j.id,token:"mock-jwt-token",refreshToken:"mock-refresh-token"}},T=async(e,t)=>{if(await E(),"123456"!==t)throw new Error("Invalid MFA code");return{success:!0,user:N("demo@example.com"),company:j,availableCompanies:[{id:j.id,name:j.name,role:y.OWNER}],activeCompanyId:j.id,token:"mock-jwt-token",refreshToken:"mock-refresh-token",mfaRequired:!1}},I=async(e,t)=>{await E();return{...N("demo@example.com"),...t}},C=async e=>{await E()},_=async(e,t)=>{await E()},M=async e=>(await E(),{token:"new-mock-jwt-token",refreshToken:"new-mock-refresh-token"}),R=async()=>(await E(),{companies:[{id:j.id,name:j.name,role:y.OWNER}],activeCompanyId:j.id,activeCompany:j}),O=async e=>{await E();return{user:N("demo@example.com"),company:j,availableCompanies:[{id:j.id,name:j.name,role:y.OWNER}],activeCompanyId:e}};class D{constructor(){this.loginAttempts=new Map,this.activeSessions=new Map,this.maxLoginAttempts=5,this.lockoutDuration=9e5,this.sessionTimeout=18e5}static getInstance(){return D.instance||(D.instance=new D),D.instance}hasPermission(e,t,s){if(!e)return!1;if(e.role===y.PRINCIPAL_ADMIN)return!0;const n=v[e.role];if(!n)return!1;const r=n.has(t);return r&&s?this.checkContextualPermissions(e,t,s):r}isAccountLocked(e){return(this.loginAttempts.get(e)||[]).filter(e=>!e.success&&Date.now()-e.timestamp<this.lockoutDuration).length>=this.maxLoginAttempts}recordLoginAttempt(e,t,s){const n=this.loginAttempts.get(e)||[];n.push({email:e,timestamp:Date.now(),success:t,...s});const r=Date.now()-864e5,a=n.filter(e=>e.timestamp>r);this.loginAttempts.set(e,a)}clearAccountLockout(e){this.loginAttempts.delete(e)}getLockoutInfo(e){const t=(this.loginAttempts.get(e)||[]).filter(e=>!e.success&&Date.now()-e.timestamp<this.lockoutDuration),s=t.length>=this.maxLoginAttempts;let n;if(s&&t.length>0){n=t[0].timestamp+this.lockoutDuration}return{isLocked:s,failedAttempts:t.length,lockoutExpiresAt:n}}validatePasswordStrength(e){const t=[];return e.length<8&&t.push("Password must be at least 8 characters long"),/[a-z]/.test(e)||t.push("Password must contain at least one lowercase letter"),/[A-Z]/.test(e)||t.push("Password must contain at least one uppercase letter"),/\d/.test(e)||t.push("Password must contain at least one number"),/[!@#$%^&*(),.?":{}|<>]/.test(e)||t.push("Password must contain at least one special character"),this.isCommonPassword(e)&&t.push("Password is too common, please choose a more unique password"),{isValid:0===t.length,errors:t}}createSession(e,t){const s=this.generateSessionId(),n=new Set(v[e.role]||[]),r={user:e,sessionId:s,lastActivity:Date.now(),permissions:n,...t};return this.activeSessions.set(s,r),this.cleanupExpiredSessions(),s}validateSession(e){const t=this.activeSessions.get(e);return t?Date.now()-t.lastActivity>this.sessionTimeout?(this.activeSessions.delete(e),null):(t.lastActivity=Date.now(),t):null}revokeSession(e){return this.activeSessions.delete(e)}revokeAllUserSessions(e){let t=0;for(const[s,n]of this.activeSessions.entries())n.user.id===e&&(this.activeSessions.delete(s),t++);return t}getSecurityMetrics(){const e=Date.now()-36e5;let t=0,s=0,n=0;for(const r of this.loginAttempts.values()){const a=r.filter(t=>t.timestamp>e);t+=a.length,s+=a.filter(e=>!e.success).length;a.filter(e=>!e.success).length>=this.maxLoginAttempts&&n++}return{activeSessions:this.activeSessions.size,totalLoginAttempts:t,failedLoginAttempts:s,lockedAccounts:n,successRate:t>0?(t-s)/t*100:100}}checkContextualPermissions(e,t,s){return t===w.MANAGE_TEAM&&s.userId?e.id===s.userId||this.hasPermission(e,w.MANAGE_TEAM):(t===w.VIEW_ALL_PROJECTS&&s.projectId,!0)}isCommonPassword(e){return["password","123456","123456789","qwerty","abc123","password123","admin","letmein","welcome","monkey"].includes(e.toLowerCase())}generateSessionId(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}cleanupExpiredSessions(){const e=Date.now();for(const[t,s]of this.activeSessions.entries())e-s.lastActivity>this.sessionTimeout&&this.activeSessions.delete(t)}}D.getInstance();let P=null;const L=(()=>{if(P)return P;try{const e=globalThis;if(e&&e.localStorage){const t="__asagents_storage_test__";return e.localStorage.setItem(t,"1"),e.localStorage.removeItem(t),P=e.localStorage,P}}catch(e){}return P=(()=>{const e=new Map;return{getItem:t=>e.has(t)?e.get(t):null,setItem(t,s){e.set(t,String(s))},removeItem(t){e.delete(t)},clear(){e.clear()},key:t=>Array.from(e.keys())[t]??null,get length(){return e.size}}})(),P})(),H=n.createContext(void 0),U=()=>{const e=n.useContext(H);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},$=({children:e})=>{const[t,s]=n.useState({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,availableCompanies:[],activeCompanyId:null,loading:!0,error:null});let r=null;const a=n.useCallback(()=>{L.removeItem("token"),L.removeItem("refreshToken"),r&&clearTimeout(r),s({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,availableCompanies:[],activeCompanyId:null,loading:!1,error:null})},[]),i=n.useCallback(e=>{r&&clearTimeout(r);try{const t=1e3*JSON.parse(atob(e.split(".")[1])).exp,n=t-Date.now(),o=Math.max(n-6e4,0);o>0&&(r=setTimeout(async()=>{const e=L.getItem("refreshToken");if(e)try{const t=await M(e);L.setItem("token",t.token),t.refreshToken&&L.setItem("refreshToken",t.refreshToken),s(e=>({...e,token:t.token,refreshToken:t.refreshToken||e.refreshToken})),i(t.token)}catch(t){a()}},o))}catch(t){}},[a]),o=n.useCallback(async e=>{s(e=>({...e,loading:!0,error:null}));try{const t=await S(e);if(t.mfaRequired)return s(e=>({...e,loading:!1})),{mfaRequired:!0,userId:t.userId};const{token:n,refreshToken:r,user:a,company:o,availableCompanies:c,activeCompanyId:l}=t;return L.setItem("token",n),r&&L.setItem("refreshToken",r),s({isAuthenticated:!0,token:n,refreshToken:r,user:a,company:o,availableCompanies:c||[],activeCompanyId:l,loading:!1,error:null}),i(n),{mfaRequired:!1}}catch(t){throw s(e=>({...e,loading:!1,error:t?.message||"Login failed"})),t}},[i]),c=n.useCallback(async e=>{s(e=>({...e,loading:!0,error:null}));try{const t=await k(e),{token:n,refreshToken:r,user:a,company:i,availableCompanies:o,activeCompanyId:c}=t;return L.setItem("token",n),r&&L.setItem("refreshToken",r),s({isAuthenticated:!0,token:n,refreshToken:r,user:a,company:i,availableCompanies:o||[],activeCompanyId:c||i.id,loading:!1,error:null}),t}catch(t){throw s(e=>({...e,loading:!1,error:t?.message||"Registration failed"})),t}},[]),l=n.useCallback(async(e,t)=>{s(e=>({...e,loading:!0,error:null}));try{const n={provider:e,token:"",email:t?.email||"",...t},r=await A(e,n),{token:a,refreshToken:o,user:c,company:l,availableCompanies:d,activeCompanyId:h}=r;return L.setItem("token",a),o&&L.setItem("refreshToken",o),s({isAuthenticated:!0,token:a,refreshToken:o,user:c,company:l,availableCompanies:d||[],activeCompanyId:h,loading:!1,error:null}),i(a),r}catch(n){throw s(e=>({...e,loading:!1,error:n?.message||"Social login failed"})),n}},[i]),d=n.useCallback(async(e,t)=>{s(e=>({...e,loading:!0,error:null}));try{const n=await T(e,t),{token:r,refreshToken:a,user:o,company:c,availableCompanies:l,activeCompanyId:d}=n;L.setItem("token",r),a&&L.setItem("refreshToken",a),s({isAuthenticated:!0,token:r,refreshToken:a,user:o,company:c,availableCompanies:l||[],activeCompanyId:d,loading:!1,error:null}),i(r)}catch(n){throw s(e=>({...e,loading:!1,error:n?.message||"MFA verification failed"})),n}},[i]),h=n.useCallback(async e=>{if(t.user)try{const n=await I(t.user.id,e);s(e=>({...e,user:n}))}catch(n){throw s(e=>({...e,error:n?.message||"Profile update failed"})),n}},[t.user]),m=n.useCallback(async e=>{try{await C(e)}catch(t){throw t}},[]),u=n.useCallback(async(e,t)=>{try{await _(e,t)}catch(s){throw s}},[]),g=n.useCallback(e=>((e,t)=>D.getInstance().hasPermission(e,t))(t.user,e),[t.user]),x=n.useCallback(async()=>{try{const e=await R();s(t=>({...t,availableCompanies:e.companies,activeCompanyId:e.activeCompanyId}))}catch(e){}},[]),f=n.useCallback(async e=>{s(e=>({...e,error:null}));try{const t=await O(e),n={...t.user,companyId:t.activeCompanyId,primaryCompanyId:t.user.primaryCompanyId??t.user.companyId};s(e=>({...e,user:n,company:t.company,availableCompanies:t.availableCompanies,activeCompanyId:t.activeCompanyId}))}catch(t){throw s(e=>({...e,error:t?.message||"Unable to switch company"})),t}},[]);n.useEffect(()=>{(async()=>{const e=L.getItem("token"),t=L.getItem("refreshToken");if(e&&t)try{s(e=>({...e,loading:!1}))}catch(n){a()}else s(e=>({...e,loading:!1}))})()},[a]);const y={...t,login:o,register:c,socialLogin:l,logout:a,hasPermission:g,verifyMfaAndFinalize:d,updateUserProfile:h,requestPasswordReset:m,resetPassword:u,refreshTenants:x,switchCompany:f};return p.jsx(H.Provider,{value:y,children:e})},W=({size:e})=>p.jsxs("svg",{className:`animate-spin ${{sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"}[e]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),V=({children:e,variant:t="primary",size:s="md",className:n="",isLoading:r=!1,...a})=>p.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] ${{primary:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border border-border",success:"bg-green-600 hover:bg-green-700 focus:ring-green-500 text-white shadow-sm",danger:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",ghost:"bg-transparent hover:bg-accent focus:ring-ring text-accent-foreground",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground"}[t]} ${{sm:"px-3 py-1.5 text-xs h-9",md:"px-5 py-2 text-sm h-10",lg:"px-6 py-3 text-base h-12"}[s]} ${n}`,...a,disabled:a.disabled||r,children:r?p.jsx(W,{size:s}):e}),G=({children:e,className:t="",...s})=>p.jsx("div",{className:`bg-card text-card-foreground rounded-[--radius] border border-border p-6 shadow-sm transition-all duration-300 ${t}`,...s,children:e});const F=new class{constructor(){this.metrics=[],this.timers=new Map}startTimer(e){this.timers.set(e,performance.now())}endTimer(e,t){const s=this.timers.get(e);if(!s)return 0;const n=performance.now()-s;return this.timers.delete(e),this.recordMetric({name:e,value:n,timestamp:Date.now(),type:"timing",tags:t}),n}recordMetric(e){this.metrics.push(e),this.metrics.length>1e3&&(this.metrics=this.metrics.slice(-1e3))}getMetrics(e){let t=this.metrics;return e&&(e.name&&(t=t.filter(t=>t.name===e.name)),e.type&&(t=t.filter(t=>t.type===e.type)),e.since&&(t=t.filter(t=>t.timestamp>=e.since))),t}getSummary(){const e=this.metrics.filter(e=>"timing"===e.type),t={},s=e.reduce((e,t)=>(e[t.name]||(e[t.name]=[]),e[t.name].push(t.value),e),{});return Object.entries(s).forEach(([e,s])=>{const n=s.sort((e,t)=>e-t);t[e]={count:s.length,min:Math.min(...s),max:Math.max(...s),avg:s.reduce((e,t)=>e+t,0)/s.length,p50:n[Math.floor(.5*n.length)],p95:n[Math.floor(.95*n.length)],p99:n[Math.floor(.99*n.length)]}}),t}clear(){this.metrics=[],this.timers.clear()}};const B=new class{constructor(e=1e3,t=3e5){this.cache=new Map,this.maxSize=e,this.defaultTTL=t}set(e,t,s){if(this.cache.size>=this.maxSize&&(this.cleanup(),this.cache.size>=this.maxSize)){const e=Array.from(this.cache.keys())[0];this.cache.delete(e)}this.cache.set(e,{data:t,timestamp:Date.now(),ttl:s||this.defaultTTL,hits:0})}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):(t.hits++,t.data):null}has(e){return null!==this.get(e)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}cleanup(){const e=Date.now();for(const[t,s]of this.cache.entries())e-s.timestamp>s.ttl&&this.cache.delete(t)}getStats(){const e=Date.now(),t=Array.from(this.cache.entries()).map(([t,s])=>({key:t,hits:s.hits,age:e-s.timestamp})),s=t.reduce((e,t)=>e+t.hits,0),n=s+t.length;return{size:this.cache.size,maxSize:this.maxSize,hitRate:n>0?s/n:0,entries:t.sort((e,t)=>t.hits-e.hits)}}}(500,12e4);var z={NODE_ENV:'"production"',VITE_API_BASE_URL:'"http://localhost:3000/api"',VITE_SUPABASE_URL:'"https://your-project.supabase.co"',VITE_SUPABASE_ANON_KEY:'"your-anon-key"',VITE_GEMINI_API_KEY:'"your_gemini_generative_language_api_key_here"',VITE_AUTH0_DOMAIN:'"your-domain.auth0.com"',VITE_AUTH0_CLIENT_ID:'"your-auth0-client-id"',VITE_GITHUB_CLIENT_ID:'"Iv23lihOkwvRyu8n7WdY"',VITE_GOOGLE_CLIENT_ID:'"your-google-client-id"'};let J=class extends n.Component{constructor(e){super(e),this.retryTimeoutId=null,this.handleRetry=()=>{const{maxRetries:e=3}=this.props;this.state.retryCount>=e||(this.setState(e=>({hasError:!1,error:null,errorInfo:null,errorId:null,retryCount:e.retryCount+1})),F.recordMetric({name:"error_boundary_retry",value:1,timestamp:Date.now(),type:"counter",tags:{retryCount:this.state.retryCount+1,level:this.props.level||"component"}}))},this.handleReload=()=>{window.location.reload()},this.handleGoHome=()=>{window.location.href="/"},this.handleCopyError=()=>{const{error:e,errorInfo:t,errorId:s}=this.state,n=`\nError ID: ${s}\nError: ${e?.name}: ${e?.message}\nStack: ${e?.stack}\nComponent Stack: ${t?.componentStack}\nURL: ${window.location.href}\nTimestamp: ${(new Date).toISOString()}\nUser Agent: ${navigator.userAgent}\n    `.trim();navigator.clipboard.writeText(n).then(()=>{}).catch(e=>{})},this.handleReportBug=()=>{const{error:e,errorInfo:t,errorId:s}=this.state,n=new URL("https://github.com/your-org/your-repo/issues/new");n.searchParams.set("title",`Bug Report: ${e?.name||"Unknown Error"}`),n.searchParams.set("body",`\n**Error ID:** ${s}\n\n**Error Message:** ${e?.message}\n\n**Steps to Reproduce:**\n1. \n2. \n3. \n\n**Expected Behavior:**\n\n\n**Actual Behavior:**\n\n\n**Additional Context:**\n- URL: ${window.location.href}\n- Timestamp: ${(new Date).toISOString()}\n- User Agent: ${navigator.userAgent}\n\n**Error Stack:**\n\`\`\`\n${e?.stack}\n\`\`\`\n\n**Component Stack:**\n\`\`\`\n${t?.componentStack}\n\`\`\`\n    `),window.open(n.toString(),"_blank")},this.state={hasError:!1,error:null,errorInfo:null,errorId:null,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorId:`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(e,t){const{onError:s,reportingEndpoint:n,level:r="component"}=this.props;this.setState({errorInfo:t}),s?.(e,t),F.recordMetric({name:"error_boundary_triggered",value:1,timestamp:Date.now(),type:"counter",tags:{level:r,errorName:e.name,errorMessage:e.message,componentStack:t.componentStack?.split("\n")[1]||"unknown"}}),this.reportError(e,t)}async reportError(e,t){const{reportingEndpoint:s}=this.props;if(s)try{const n={errorId:this.state.errorId,message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,userId:this.getUserId(),sessionId:this.getSessionId(),buildVersion:z.REACT_APP_VERSION||"unknown",level:this.props.level||"component"};await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(n){}}getUserId(){try{return JSON.parse(localStorage.getItem("user")||"{}").id||null}catch{return null}}getSessionId(){try{return sessionStorage.getItem("sessionId")||null}catch{return null}}render(){const{hasError:e,error:t,errorInfo:s,errorId:n,retryCount:l}=this.state,{children:d,fallback:h,enableRetry:m=!0,maxRetries:u=3,showErrorDetails:g=!1,level:x="component"}=this.props;return e?h||("critical"===x?p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:p.jsxs(G,{className:"max-w-lg w-full p-8 text-center",children:[p.jsx("div",{className:"text-red-500 mb-6",children:p.jsx(r,{size:64,className:"mx-auto"})}),p.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Critical Error"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"A critical error has occurred that prevents the application from functioning properly. Please reload the page or contact support if the problem persists."}),n&&p.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Error ID: ",p.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:n})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[p.jsxs(V,{onClick:this.handleReload,className:"flex items-center gap-2",children:[p.jsx(a,{size:16}),"Reload Page"]}),p.jsxs(V,{variant:"outline",onClick:this.handleGoHome,className:"flex items-center gap-2",children:[p.jsx(i,{size:16}),"Go Home"]})]})]})}):p.jsx(G,{className:"p-6 border-red-200 bg-red-50",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"text-red-500 flex-shrink-0",children:p.jsx(r,{size:24})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),p.jsx("p",{className:"text-red-700 mb-4",children:"page"===x?"This page encountered an error and cannot be displayed properly.":"This component encountered an error and cannot be displayed properly."}),n&&p.jsxs("p",{className:"text-sm text-red-600 mb-4",children:["Error ID: ",p.jsx("code",{className:"bg-red-100 px-2 py-1 rounded text-xs",children:n})]}),p.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[m&&l<u&&p.jsxs(V,{size:"sm",onClick:this.handleRetry,className:"flex items-center gap-2",children:[p.jsx(a,{size:14}),"Try Again ",l>0&&`(${l}/${u})`]}),p.jsxs(V,{size:"sm",variant:"outline",onClick:this.handleCopyError,className:"flex items-center gap-2",children:[p.jsx(o,{size:14}),"Copy Error"]}),p.jsxs(V,{size:"sm",variant:"outline",onClick:this.handleReportBug,className:"flex items-center gap-2",children:[p.jsx(c,{size:14}),"Report Bug"]})]}),g&&t&&p.jsxs("details",{className:"mt-4",children:[p.jsx("summary",{className:"cursor-pointer text-sm font-medium text-red-800 mb-2",children:"Error Details"}),p.jsxs("div",{className:"bg-red-100 p-3 rounded text-xs font-mono overflow-auto max-h-40",children:[p.jsxs("div",{className:"mb-2",children:[p.jsx("strong",{children:"Error:"})," ",t.name,": ",t.message]}),t.stack&&p.jsxs("div",{className:"mb-2",children:[p.jsx("strong",{children:"Stack:"}),p.jsx("pre",{className:"whitespace-pre-wrap mt-1",children:t.stack})]}),s?.componentStack&&p.jsxs("div",{children:[p.jsx("strong",{children:"Component Stack:"}),p.jsx("pre",{className:"whitespace-pre-wrap mt-1",children:s.componentStack})]})]})]})]})]})})):d}};const Y={apiUrl:"http://localhost:3000/api"};const q=new class{constructor(e={}){this.ws=null,this.eventHandlers=new Map,this.connectionHandlers=new Set,this.disconnectionHandlers=new Set,this.errorHandlers=new Set,this.messageQueue=[],this.reconnectAttempts=0,this.reconnectTimer=null,this.heartbeatTimer=null,this.isConnecting=!1,this.shouldReconnect=!0,this.latencyMeasurements=[],this.authToken=null,this.tenantId=null,this.userId=null;const t=Y;this.url=t.wsUrl||"ws://localhost:3001",this.options={reconnectInterval:3e3,maxReconnectAttempts:10,heartbeatInterval:3e4,debug:!1,autoConnect:!0,messageQueueSize:100,compressionEnabled:!0,...e},this.stats={connected:!1,reconnectAttempts:0,messagesSent:0,messagesReceived:0,bytesTransferred:0,averageLatency:0},this.options.autoConnect&&this.connect().catch(e=>{this.log("Auto-connect failed:",e)})}setAuth(e,t,s){this.authToken=e,this.tenantId=t||null,this.userId=s||null,this.isConnected()&&(this.disconnect(),this.connect())}clearAuth(){this.authToken=null,this.tenantId=null,this.userId=null}connect(){return new Promise((e,t)=>{if(this.ws?.readyState!==WebSocket.OPEN){if(!this.isConnecting){this.isConnecting=!0,this.log("Connecting to WebSocket...");try{let s=this.url;const n=new URLSearchParams;this.authToken&&n.append("token",this.authToken),this.tenantId&&n.append("tenantId",this.tenantId.toString()),this.userId&&n.append("userId",this.userId),n.toString()&&(s+=`?${n.toString()}`),this.ws=new WebSocket(s),this.ws.onopen=()=>{this.log("WebSocket connected"),this.isConnecting=!1,this.reconnectAttempts=0,this.stats.connected=!0,this.stats.lastConnected=new Date,this.startHeartbeat(),this.processMessageQueue(),this.notifyConnectionHandlers(),F.recordMetric({name:"websocket_connection",value:1,timestamp:Date.now(),type:"counter"}),e()},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t),this.stats.messagesReceived++,this.stats.bytesTransferred+=e.data.length}catch(t){this.log("Failed to parse message:",t),this.notifyErrorHandlers(new Error("Failed to parse WebSocket message"))}},this.ws.onclose=e=>{this.log("WebSocket disconnected:",e.code,e.reason),this.isConnecting=!1,this.stats.connected=!1,this.stats.lastDisconnected=new Date,this.stopHeartbeat(),this.notifyDisconnectionHandlers(),F.recordMetric({name:"websocket_disconnection",value:1,timestamp:Date.now(),type:"counter",tags:{code:e.code.toString()}}),this.shouldReconnect&&this.reconnectAttempts<this.options.maxReconnectAttempts&&this.scheduleReconnect()},this.ws.onerror=e=>{this.log("WebSocket error:",e),this.isConnecting=!1,this.notifyErrorHandlers(new Error("WebSocket connection error")),t(e)}}catch(s){this.isConnecting=!1,t(s)}}}else e()})}disconnect(){this.shouldReconnect=!1,this.clearReconnectTimer(),this.stopHeartbeat(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.stats.connected=!1}send(e,t,s={}){const n={type:e,data:t,timestamp:Date.now(),id:this.generateId(),tenantId:this.tenantId||void 0,userId:this.userId||void 0,priority:s.priority||"normal"};this.ws?.readyState===WebSocket.OPEN?this.sendMessage(n):(this.queueMessage(n),this.log("Message queued (not connected):",n))}sendWithAck(e,t,s=5e3){return new Promise((n,r)=>{const a=this.generateId(),i=setTimeout(()=>{this.off(`ack_${a}`,o),r(new Error("Message acknowledgment timeout"))},s),o=e=>{clearTimeout(i),n(e)};this.on(`ack_${a}`,o),this.send(e,{...t,_ackId:a})})}subscribe(e,t,s){const n=(e,n)=>{if(s)for(const[t,r]of Object.entries(s))if(n[t]!==r)return;t(e,n)};return this.on(e,n),()=>this.off(e,n)}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t)}off(e,t){const s=this.eventHandlers.get(e);s&&(s.delete(t),0===s.size&&this.eventHandlers.delete(e))}onConnect(e){this.connectionHandlers.add(e)}onDisconnect(e){this.disconnectionHandlers.add(e)}onError(e){this.errorHandlers.add(e)}isConnected(){return this.ws?.readyState===WebSocket.OPEN}getStats(){return{...this.stats}}clearQueue(){this.messageQueue=[]}getQueueSize(){return this.messageQueue.length}sendMessage(e){try{const t=JSON.stringify(e);this.ws.send(t),this.stats.messagesSent++,this.stats.bytesTransferred+=t.length,this.log("Sent message:",e),"heartbeat"===e.type&&this.latencyMeasurements.push(Date.now())}catch(t){this.log("Failed to send message:",t),this.notifyErrorHandlers(new Error("Failed to send WebSocket message"))}}queueMessage(e){this.messageQueue.length>=this.options.messageQueueSize&&this.messageQueue.shift(),"critical"===e.priority?this.messageQueue.unshift(e):this.messageQueue.push(e)}processMessageQueue(){for(;this.messageQueue.length>0&&this.isConnected();){const e=this.messageQueue.shift();this.sendMessage(e)}}handleMessage(e){if(this.log("Received message:",e),"heartbeat_ack"===e.type)return void this.updateLatency(e.timestamp);if(e.type.startsWith("ack_")){const t=this.eventHandlers.get(e.type);return void(t&&t.forEach(t=>{try{t(e.data,e)}catch(s){this.log("Error in ack handler:",s)}}))}const t=this.eventHandlers.get(e.type);t&&t.forEach(t=>{try{t(e.data,e)}catch(s){this.log("Error in event handler:",s),this.notifyErrorHandlers(s)}}),e.data?._ackId&&this.send(`ack_${e.data._ackId}`,{received:!0})}updateLatency(e){const t=Date.now()-e;this.latencyMeasurements.push(t),this.latencyMeasurements.length>10&&this.latencyMeasurements.shift(),this.stats.averageLatency=this.latencyMeasurements.reduce((e,t)=>e+t,0)/this.latencyMeasurements.length}scheduleReconnect(){this.clearReconnectTimer(),this.reconnectAttempts++,this.stats.reconnectAttempts=this.reconnectAttempts;const e=Math.min(this.options.reconnectInterval*Math.pow(2,this.reconnectAttempts-1),3e4);this.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${e}ms`),this.reconnectTimer=setTimeout(()=>{this.connect().catch(e=>{this.log("Reconnect failed:",e),this.notifyErrorHandlers(new Error("Reconnection failed"))})},e)}clearReconnectTimer(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}startHeartbeat(){this.stopHeartbeat(),this.heartbeatTimer=setInterval(()=>{this.send("heartbeat",{timestamp:Date.now()})},this.options.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}notifyConnectionHandlers(){this.connectionHandlers.forEach(e=>{try{e(this.getStats())}catch(t){this.log("Error in connection handler:",t)}})}notifyDisconnectionHandlers(){this.disconnectionHandlers.forEach(e=>{try{e(this.getStats())}catch(t){this.log("Error in disconnection handler:",t)}})}notifyErrorHandlers(e){this.errorHandlers.forEach(t=>{try{t(e)}catch(s){this.log("Error in error handler:",s)}})}generateId(){return Math.random().toString(36).substr(2,9)}log(...e){this.options.debug}}({debug:!0});const K=new class{constructor(){this.retryAttempts=3,this.retryDelay=1e3;const e=Y;this.baseUrl=e.apiUrl,this.defaultHeaders={"Content-Type":"application/json"}}setAuthToken(e){this.defaultHeaders.Authorization=`Bearer ${e}`}clearAuthToken(){delete this.defaultHeaders.Authorization}getCacheKey(e,t){return`${t.method||"GET"}:${e}:${t.body?JSON.stringify(t.body):""}`}async retryRequest(e,t=this.retryAttempts){try{return await e()}catch(s){if(t>0&&this.shouldRetry(s))return await this.delay(this.retryDelay*(this.retryAttempts-t+1)),this.retryRequest(e,t-1);throw s}}shouldRetry(e){return"AbortError"!==e.name&&!(e.status>=400&&e.status<500)}delay(e){return new Promise(t=>setTimeout(t,e))}async request(e,t={}){const{method:s="GET",headers:n={},body:r,cache:a="GET"===s,cacheTTL:i=3e5,retries:o=this.retryAttempts,timeout:c=3e4,signal:l}=t,d=`${this.baseUrl}${e}`,h=this.getCacheKey(d,t);if(a&&"GET"===s){const t=B.get(h);if(t)return F.recordMetric({name:`api_${e.replace(/\//g,"_")}_cached`,value:1,timestamp:Date.now(),type:"counter"}),t}const m=`api_${e.replace(/\//g,"_")}`;F.startTimer(m);try{const t=await this.retryRequest(async()=>{const e=new AbortController,t=setTimeout(()=>e.abort(),c);try{const a=await fetch(d,{method:s,headers:{...this.defaultHeaders,...n},body:r?JSON.stringify(r):void 0,signal:l||e.signal});if(clearTimeout(t),!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(a){throw clearTimeout(t),a}},o);return a&&"GET"===s&&B.set(h,t,i),F.endTimer(m,{status:"success",method:s,endpoint:e}),t}catch(u){throw F.endTimer(m,{status:"error",method:s,endpoint:e,error:u instanceof Error?u.message:"Unknown error"}),u}}async get(e,t,s){const n=t?"?"+new URLSearchParams(t).toString():"";return this.request(`${e}${n}`,{...s,method:"GET"})}async post(e,t,s){return this.request(e,{...s,method:"POST",body:t})}async put(e,t,s){return this.request(e,{...s,method:"PUT",body:t})}async patch(e,t,s){return this.request(e,{...s,method:"PATCH",body:t})}async delete(e,t){return this.request(e,{...t,method:"DELETE"})}async getPaginated(e,t={},s){const{page:n=1,limit:r=20,sort:a,order:i="asc",search:o,filters:c={}}=t,l={page:n.toString(),limit:r.toString()};return a&&(l.sort=a,l.order=i),o&&(l.search=o),Object.entries(c).forEach(([e,t])=>{null!=t&&""!==t&&(l[e]=t.toString())}),this.get(e,l,s)}async uploadFile(e,t,s,n){return new Promise((r,a)=>{const i=new FormData;i.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{i.append(e,t.toString())});const o=new XMLHttpRequest;o.upload.onprogress=e=>{if(e.lengthComputable&&n){const t=Math.round(e.loaded/e.total*100);n(t)}},o.onload=()=>{if(o.status>=200&&o.status<300)try{const e=JSON.parse(o.responseText);r(e)}catch(e){a(new Error("Invalid response format"))}else a(new Error(`Upload failed with status ${o.status}`))},o.onerror=()=>a(new Error("Upload failed")),o.open("POST",`${this.baseUrl}${e}`),this.defaultHeaders.Authorization&&o.setRequestHeader("Authorization",this.defaultHeaders.Authorization),o.send(i)})}async batch(e){const t=e.map(({endpoint:e,options:t})=>this.request(e,t).catch(e=>e));return Promise.all(t)}async healthCheck(){try{return await this.get("/health",void 0,{cache:!1,timeout:5e3}),!0}catch{return!1}}clearCache(){B.clear()}getCacheStats(){return B.getStats()}};const Q=new class{constructor(){this.baseUrl="https://generativelanguage.googleapis.com/v1beta";const e=Y;this.config=e.gemini}getConfig(){return this.config}isEnabled(){return this.config.enabled}async generateContent(e,t={}){if(!this.config.enabled)throw new Error("Gemini service is not configured");const s=t.model||"gemini-pro",n=this.config.apiKey,r={contents:[{parts:[{text:e}],role:"user"}],generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024,...t.generationConfig},safetySettings:t.safetySettings||[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]};try{const e=await fetch(`${this.baseUrl}/models/${s}:generateContent?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(`Gemini API error: ${e.status} ${e.statusText}. ${t.error?.message||""}`)}const t=await e.json();if(!t.candidates||0===t.candidates.length)throw new Error("No response generated from Gemini");const a=t.candidates[0];if(!a.content||!a.content.parts||0===a.content.parts.length)throw new Error("Invalid response format from Gemini");return a.content.parts[0].text}catch(a){throw a}}async generateContentWithImage(e,t,s,n={}){if(!this.config.enabled)throw new Error("Gemini service is not configured");const r={contents:[{parts:[{text:e},{inlineData:{mimeType:s,data:t}}],role:"user"}],generationConfig:{temperature:.4,topK:32,topP:1,maxOutputTokens:4096,...n.generationConfig},safetySettings:n.safetySettings||[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]};try{const e=await fetch(`${this.baseUrl}/models/gemini-pro-vision:generateContent?key=${this.config.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(`Gemini API error: ${e.status} ${e.statusText}. ${t.error?.message||""}`)}const t=await e.json();if(!t.candidates||0===t.candidates.length)throw new Error("No response generated from Gemini Vision");const s=t.candidates[0];if(!s.content||!s.content.parts||0===s.content.parts.length)throw new Error("Invalid response format from Gemini Vision");return s.content.parts[0].text}catch(a){throw a}}async countTokens(e,t="gemini-pro"){if(!this.config.enabled)throw new Error("Gemini service is not configured");try{const s=await fetch(`${this.baseUrl}/models/${t}:countTokens?key=${this.config.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!s.ok)throw new Error(`Token count error: ${s.status} ${s.statusText}`);return(await s.json()).totalTokens||0}catch(s){return 0}}async getModels(){if(!this.config.enabled)throw new Error("Gemini service is not configured");try{const e=await fetch(`${this.baseUrl}/models?key=${this.config.apiKey}`);if(!e.ok)throw new Error(`Models list error: ${e.status} ${e.statusText}`);const t=await e.json();return t.models?.map(e=>e.name)||[]}catch(e){return["gemini-pro","gemini-pro-vision"]}}},Z={async generateCompletion(e,t={}){const{model:s="gpt-4-turbo-preview",maxTokens:n=2048}=t;throw new Error("OpenAI API key not configured")},async*streamChatCompletion(e,t={}){const{model:s="gpt-4-turbo-preview",maxTokens:n=2048}=t;throw new Error("OpenAI API key not configured")},async analyzeConstructionDocument(e){const t=`\n      Analyze this construction document and extract key information:\n      ${e}\n      \n      Please provide:\n      1. Document type (invoice, contract, report, etc.)\n      2. Key dates\n      3. Financial information\n      4. Risk factors\n      5. Action items\n      6. Summary\n      \n      Format the response as JSON.\n    `;try{const e=await this.generateCompletion(t);return JSON.parse(e)}catch(s){return{documentType:"Unknown",summary:"Analysis failed",error:s.message}}},testConnection:async()=>!1};const X=new class{constructor(){this.connectionStatus={backend:"unknown",database:"unknown",websocket:"unknown",ai:"unknown"},this.healthCheckInterval=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.initializeHealthChecks(),this.setupEventListeners()}async initializeHealthChecks(){await this.checkAllConnections(),this.startHealthCheckInterval()}async checkAllConnections(){const e=await Promise.allSettled([this.checkBackendHealth(),this.checkDatabaseHealth(),this.checkWebSocketHealth(),this.checkAIServicesHealth()]);return this.connectionStatus={backend:"fulfilled"===e[0].status?"connected":"disconnected",database:"fulfilled"===e[1].status?"connected":"disconnected",websocket:"fulfilled"===e[2].status?"connected":"disconnected",ai:"fulfilled"===e[3].status?"connected":"disconnected"},window.dispatchEvent(new CustomEvent("connectivity-update",{detail:this.connectionStatus})),this.connectionStatus}async checkBackendHealth(){try{const e=await fetch("http://localhost:3000/api/api/health",{method:"GET",timeout:5e3});if(!e.ok)throw new Error(`Backend health check failed: ${e.status}`);if("healthy"!==(await e.json()).status)throw new Error("Backend reports unhealthy status")}catch(e){throw e}}async checkDatabaseHealth(){try{if("connected"!==(await K.get("/api/system/database/health")).data.status)throw new Error("Database connection failed")}catch(e){throw e}}async checkWebSocketHealth(){return new Promise((e,t)=>{const s=setTimeout(()=>{t(new Error("WebSocket health check timeout"))},5e3);q.isConnected()?(clearTimeout(s),e()):q.connect().then(()=>{clearTimeout(s),e()}).catch(e=>{clearTimeout(s),t(e)})})}async checkAIServicesHealth(){try{await Q.testConnection(),await(Z.testConnection?.())}catch(e){throw e}}startHealthCheckInterval(){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),this.healthCheckInterval=setInterval(()=>{this.checkAllConnections().catch(console.error)},3e4)}setupEventListeners(){window.addEventListener("online",()=>{this.handleReconnect()}),window.addEventListener("offline",()=>{this.connectionStatus={backend:"disconnected",database:"disconnected",websocket:"disconnected",ai:"disconnected"}}),q.on("connected",()=>{this.connectionStatus.websocket="connected"}),q.on("disconnected",()=>{this.connectionStatus.websocket="disconnected",this.handleReconnect()})}async handleReconnect(){if(!(this.reconnectAttempts>=this.maxReconnectAttempts)){this.reconnectAttempts++;try{await this.checkAllConnections(),this.reconnectAttempts=0}catch(e){const t=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);setTimeout(()=>this.handleReconnect(),t)}}}getConnectionStatus(){return{...this.connectionStatus}}isFullyConnected(){return Object.values(this.connectionStatus).every(e=>"connected"===e)}hasConnectionIssues(){return Object.values(this.connectionStatus).some(e=>"disconnected"===e)}async forceReconnect(){this.reconnectAttempts=0,await this.handleReconnect()}destroy(){this.healthCheckInterval&&clearInterval(this.healthCheckInterval)}};function ee({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const te=n.forwardRef(ee);function se({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const ne=n.forwardRef(se);function re({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const ae=n.forwardRef(re);function ie({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const oe=n.forwardRef(ie);function ce({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const le=n.forwardRef(ce);function de({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))}const he=n.forwardRef(de);function me({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const ue=n.forwardRef(me);function ge({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"}))}const pe=n.forwardRef(ge);function xe({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const fe=n.forwardRef(xe);function ye({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const we=n.forwardRef(ye);function ve({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const be=n.forwardRef(ve);function Ee({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const je=n.forwardRef(Ee);function Ne({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const Se=n.forwardRef(Ne);function ke({title:e,titleId:t,...s},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const Ae=n.forwardRef(ke),Te=()=>{const[e,t]=n.useState(X.getConnectionStatus()),[s,r]=n.useState(!1);n.useEffect(()=>{const e=e=>{t(e.detail);const s=Object.values(e.detail).some(e=>"disconnected"===e);r(s)};return window.addEventListener("connectivity-update",e),()=>{window.removeEventListener("connectivity-update",e)}},[]);const a=e=>{switch(e){case"connected":return"text-green-600";case"disconnected":return"text-red-600";default:return"text-yellow-600"}};return!s&&X.isFullyConnected()?null:p.jsxs("div",{className:"fixed bottom-4 right-4 bg-white rounded-lg shadow-lg p-4 border border-gray-200 z-50",children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"System Status"}),p.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),p.jsx("div",{className:"space-y-2",children:Object.entries(e).map(([e,t])=>{const s=(e=>{switch(e){case"connected":return fe;case"disconnected":return be;default:return ne}})(t);return p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(s,{className:`h-4 w-4 ${a(t)}`}),p.jsx("span",{className:"text-sm text-gray-700 capitalize",children:e}),p.jsx("span",{className:`text-xs font-medium ${a(t)}`,children:t})]},e)})}),X.hasConnectionIssues()&&p.jsxs("button",{onClick:async()=>{await X.forceReconnect()},className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors flex items-center justify-center space-x-1",children:[p.jsx(ne,{className:"h-4 w-4"}),p.jsx("span",{children:"Reconnect"})]})]})};class Ie{constructor(){this.healthCheckInterval=null,this.metricsCache=new Map,this.CACHE_TTL=3e5}static getInstance(){return this.instance||(this.instance=new Ie),this.instance}assessDashboardHealth(e,t,s,n,r,a){const i=[];let o=100;0===e.length&&(i.push({type:"data",severity:"high",message:"No projects found",affectedComponents:["projects","dashboard"],suggestedFix:"Create at least one project to get started"}),o-=20);const c=t.filter(e=>e.dueDate&&new Date(e.dueDate)<new Date&&"DONE"!==e.status);c.length>5&&(i.push({type:"user_experience",severity:"medium",message:`${c.length} overdue tasks detected`,affectedComponents:["tasks","productivity"],suggestedFix:"Review and update task deadlines or mark completed tasks as done"}),o-=10);const l=n.filter(e=>"CRITICAL"===e.severity&&"OPEN"===e.status);l.length>0&&(i.push({type:"security",severity:"critical",message:`${l.length} critical safety incidents require immediate attention`,affectedComponents:["safety","compliance"],suggestedFix:"Address critical safety incidents immediately"}),o-=30);let d;a.filter(e=>e.isActive).length<2&&(i.push({type:"data",severity:"medium",message:"Limited team members available",affectedComponents:["team","collaboration"],suggestedFix:"Add more team members or activate existing members"}),o-=15),d=o>=90?"excellent":o>=75?"good":o>=50?"warning":"critical";const h=this.generateRecommendations(i);return{status:d,score:Math.max(0,o),issues:i,recommendations:h}}performDataIntegrityCheck(e,t,s,n){const r=[],a=[],i=[],o=this.checkProjectIntegrity(e);r.push(o);const c=this.checkTaskProjectRelationships(t,e);r.push(c);const l=this.checkExpenseProjectRelationships(s,e);r.push(l);const d=this.checkTeamAssignments(t,n);r.push(d);const h=r.reduce((e,t)=>e+t.score,0)/r.length;r.forEach(e=>{"fail"!==e.status&&"warning"!==e.status||(e.details.includes("missing")?a.push(e.details):i.push(e.details))});const m=this.generateIntegrityRecommendations(r);return{overallScore:h,checks:r,missingData:a,inconsistencies:i,recommendations:m}}getRealTimeMetrics(){return{activeUsers:Math.floor(50*Math.random())+10,systemLoad:100*Math.random(),responseTime:200*Math.random()+50,errorCount:Math.floor(5*Math.random()),lastUpdated:new Date}}generateDashboardAnalytics(){return{userEngagement:{sessionDuration:3600*Math.random()+1800,pageViews:Math.floor(100*Math.random())+50,interactionRate:.4*Math.random()+.6,bounceRate:.3*Math.random()+.1},featureUsage:{mostUsedFeatures:["projects","tasks","dashboard"],leastUsedFeatures:["reports","settings"],newFeatureAdoption:.5*Math.random()+.3},performance:{averageLoadTime:2e3*Math.random()+500,errorRate:.05*Math.random(),uptime:99.5+.5*Math.random(),cacheHitRate:.3*Math.random()+.7}}}startHealthMonitoring(e){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),this.healthCheckInterval=setInterval(()=>{e({status:"good",score:85,issues:[],recommendations:["Regular data backup recommended","Consider upgrading to premium plan"]})},3e4)}stopHealthMonitoring(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}checkProjectIntegrity(e){let t=100,s="All projects have complete data",n="pass";const r=e.filter(e=>!e.name||!e.description||!e.startDate);return r.length>0&&(t=Math.max(0,100-r.length/e.length*100),s=`${r.length} projects have missing required data`,n=r.length>.5*e.length?"fail":"warning"),{name:"Project Data Integrity",status:n,score:t,details:s,impact:"fail"===n?"high":"warning"===n?"medium":"low"}}checkTaskProjectRelationships(e,t){const s=new Set(t.map(e=>e.id)),n=e.filter(e=>e.projectId&&!s.has(e.projectId));let r=100,a="pass",i="All tasks are properly linked to projects";return n.length>0&&(r=Math.max(0,100-n.length/e.length*100),i=`${n.length} tasks reference non-existent projects`,a=n.length>.1*e.length?"fail":"warning"),{name:"Task-Project Relationships",status:a,score:r,details:i,impact:"fail"===a?"high":"medium"}}checkExpenseProjectRelationships(e,t){const s=new Set(t.map(e=>e.id)),n=e.filter(e=>e.projectId&&!s.has(e.projectId));let r=100,a="pass",i="All expenses are properly linked to projects";return n.length>0&&(r=Math.max(0,100-n.length/e.length*100),i=`${n.length} expenses reference non-existent projects`,a=n.length>.1*e.length?"fail":"warning"),{name:"Expense-Project Relationships",status:a,score:r,details:i,impact:"medium"}}checkTeamAssignments(e,t){const s=new Set(t.map(e=>e.id)),n=e.filter(e=>e.assignedTo&&!s.has(e.assignedTo));let r=100,a="pass",i="All tasks are assigned to valid team members";return n.length>0&&(r=Math.max(0,100-n.length/e.length*100),i=`${n.length} tasks assigned to non-existent team members`,a=n.length>.1*e.length?"fail":"warning"),{name:"Team Assignments",status:a,score:r,details:i,impact:"medium"}}generateRecommendations(e){const t=[];return e.some(e=>"data"===e.type)&&t.push("Review and complete missing data fields"),e.some(e=>"security"===e.type)&&t.push("Address security issues immediately"),e.some(e=>"critical"===e.severity)&&t.push("Focus on critical issues first"),t.push("Regular data validation and cleanup"),t.push("Monitor dashboard health metrics"),t}generateIntegrityRecommendations(e){const t=[],s=e.filter(e=>"fail"===e.status),n=e.filter(e=>"warning"===e.status);return s.length>0&&t.push("Address failed integrity checks immediately"),n.length>0&&t.push("Review and fix warning-level integrity issues"),t.push("Implement automated data validation"),t.push("Regular integrity monitoring"),t}}class Ce{constructor(){this.events=[],this.metrics=[],this.batchSize=50,this.flushInterval=3e4,this.maxRetries=3,this.currentSession=this.createSession(),this.setupPerformanceMonitoring(),this.setupAutoFlush(),this.setupPageVisibilityTracking()}static getInstance(){return Ce.instance||(Ce.instance=new Ce),Ce.instance}track(e,t){const s={name:e,properties:this.sanitizeProperties(t),timestamp:Date.now(),userId:this.getCurrentUserId(),sessionId:this.currentSession.id,metadata:{url:window.location.href,userAgent:navigator.userAgent,viewport:`${window.innerWidth}x${window.innerHeight}`}};this.events.push(s),this.currentSession.events.push(s),this.updateSessionActivity(),this.events.length>=this.batchSize&&this.flush()}trackPageView(e,t){this.track("page_view",{path:e,title:t||document.title,referrer:document.referrer}),this.currentSession.pageViews++}trackClick(e,t){this.track("click",{element:e,...t})}trackFormSubmit(e,t,s){this.track("form_submit",{form_name:e,success:t,errors:s})}trackSearch(e,t,s){this.track("search",{query:e,results_count:t,filters:s})}trackError(e,t){this.track("error",{error_name:e.name,error_message:e.message,error_stack:e.stack,context:t})}trackPerformance(e,t,s,n){const r={name:e,value:t,unit:s,timestamp:Date.now(),tags:n};this.metrics.push(r),this.metrics.length>=this.batchSize&&this.flushMetrics()}trackLoadTime(e,t){this.trackPerformance("page_load_time",t,"ms",{page:e})}trackApiCall(e,t,s,n){this.trackPerformance("api_call_duration",s,"ms",{endpoint:e,method:t,status:n.toString()})}identify(e,t){this.currentSession.userId=e,this.track("identify",{user_id:e,traits:this.sanitizeProperties(t)})}startNewSession(){this.endCurrentSession(),this.currentSession=this.createSession()}endCurrentSession(){this.track("session_end",{session_duration:Date.now()-this.currentSession.startTime,page_views:this.currentSession.pageViews,events_count:this.currentSession.events.length}),this.flush()}getSessionData(){return{...this.currentSession}}getEventsSummary(e){const t=e?this.events.filter(t=>t.timestamp>=e.start&&t.timestamp<=e.end):this.events,s=t.reduce((e,t)=>(e[t.name]=(e[t.name]||0)+1,e),{});return{totalEvents:t.length,eventTypes:Object.keys(s).length,breakdown:s}}getPerformanceMetrics(e){const t=e?this.metrics.filter(t=>t.name===e):this.metrics;if(0===t.length)return null;const s=t.map(e=>e.value);return{count:t.length,min:Math.min(...s),max:Math.max(...s),avg:s.reduce((e,t)=>e+t,0)/s.length,p95:this.percentile(s,95),p99:this.percentile(s,99)}}async flush(){if(0===this.events.length)return;const e=[...this.events];this.events=[];try{await this.sendEvents(e)}catch(t){this.events.unshift(...e)}}async flushMetrics(){if(0===this.metrics.length)return;const e=[...this.metrics];this.metrics=[];try{await this.sendMetrics(e)}catch(t){this.metrics.unshift(...e)}}createSession(){return{id:this.generateSessionId(),startTime:Date.now(),lastActivity:Date.now(),pageViews:0,events:[],userAgent:navigator.userAgent,referrer:document.referrer}}updateSessionActivity(){this.currentSession.lastActivity=Date.now()}getCurrentUserId(){return this.currentSession.userId}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}sanitizeProperties(e){if(!e)return;const t={};for(const[s,n]of Object.entries(e))"function"!=typeof n&&void 0!==n&&("string"==typeof n&&n.length>1e3?t[s]=n.substring(0,1e3)+"...":t[s]=n);return t}setupPerformanceMonitoring(){if("performance"in window&&"getEntriesByType"in performance&&window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&this.trackLoadTime("initial_page_load",e.loadEventEnd-e.fetchStart)},0)}),"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformance("long_task",t.duration,"ms")}).observe({entryTypes:["longtask"]})}catch(e){}}setupAutoFlush(){setInterval(()=>{this.flush(),this.flushMetrics()},this.flushInterval),window.addEventListener("beforeunload",()=>{this.endCurrentSession()})}setupPageVisibilityTracking(){document.addEventListener("visibilitychange",()=>{document.hidden?this.track("page_hidden"):(this.track("page_visible"),this.updateSessionActivity())})}async sendEvents(e){await new Promise(e=>setTimeout(e,100))}async sendMetrics(e){await new Promise(e=>setTimeout(e,100))}percentile(e,t){const s=[...e].sort((e,t)=>e-t);return s[Math.ceil(t/100*s.length)-1]}}Ce.getInstance();const _e=new Ie,Me=new Ce,Re=({title:e,value:t,total:s,icon:n,trend:r,trendDirection:a,subtitle:i,color:o="blue"})=>p.jsx("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm font-medium text-gray-600 truncate",children:e}),p.jsx("div",{className:"flex items-baseline mt-2",children:p.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[t,s&&p.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-1",children:["/ ",s]})]})}),r&&p.jsx("div",{className:"flex items-center mt-2",children:a&&p.jsxs("span",{className:`flex items-center text-sm ${{up:"text-green-600",down:"text-red-600"}[a]}`,children:["up"===a?p.jsx(oe,{className:"h-4 w-4 mr-1"}):p.jsx(te,{className:"h-4 w-4 mr-1"}),r]})}),i&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]}),p.jsx("div",{className:`p-3 rounded-lg ${{blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600"}[o]}`,children:p.jsx(n,{className:"h-6 w-6"})})]})}),Oe=({projects:e=[],detailed:t=!1})=>{const s=e=>{switch(e.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"delayed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Projects Overview"}),p.jsxs("span",{className:"text-sm text-gray-500",children:[e.length," projects"]})]}),p.jsxs("div",{className:"space-y-4",children:[e.slice(0,t?e.length:5).map(e=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.name}),p.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s(e.status)}`,children:e.status})]}),p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:p.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.progress}%`}})}),p.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[p.jsxs("span",{children:[e.progress,"% complete"]}),p.jsxs("span",{children:["$",(e.budget/1e3).toFixed(0),"k budget"]})]})]},e.id)),0===e.length&&p.jsx("div",{className:"text-center py-8 text-gray-500",children:p.jsx("p",{children:"No projects data available"})})]})]})},De=({financials:e,detailed:t=!1})=>{if(!e)return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Financial Summary"}),p.jsx("div",{className:"text-center py-8 text-gray-500",children:p.jsx("p",{children:"No financial data available"})})]});const s=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Financial Summary"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[p.jsx("p",{className:"text-2xl font-bold text-green-600",children:s(e.totalRevenue)}),p.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),p.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[p.jsx("p",{className:"text-2xl font-bold text-red-600",children:s(e.totalCosts)}),p.jsx("p",{className:"text-sm text-gray-600",children:"Total Costs"})]}),p.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[p.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[e.profitMargin.toFixed(1),"%"]}),p.jsx("p",{className:"text-sm text-gray-600",children:"Profit Margin"})]})]}),t&&e.cashFlow&&p.jsxs("div",{className:"mt-6",children:[p.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Cash Flow"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"text-center p-3 border rounded",children:[p.jsx("p",{className:"text-lg font-semibold text-green-600",children:s(e.cashFlow.inflow)}),p.jsx("p",{className:"text-xs text-gray-600",children:"Inflow"})]}),p.jsxs("div",{className:"text-center p-3 border rounded",children:[p.jsx("p",{className:"text-lg font-semibold text-red-600",children:s(e.cashFlow.outflow)}),p.jsx("p",{className:"text-xs text-gray-600",children:"Outflow"})]}),p.jsxs("div",{className:"text-center p-3 border rounded",children:[p.jsx("p",{className:"text-lg font-semibold "+(e.cashFlow.net>=0?"text-green-600":"text-red-600"),children:s(e.cashFlow.net)}),p.jsx("p",{className:"text-xs text-gray-600",children:"Net Flow"})]})]})]})]})},Pe=({team:e,detailed:t=!1})=>{if(!e)return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Team Performance"}),p.jsx("div",{className:"text-center py-8 text-gray-500",children:p.jsx("p",{children:"No team data available"})})]});const s=e=>{switch(e.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"busy":return"bg-yellow-100 text-yellow-800";case"away":return"bg-gray-100 text-gray-800";default:return"bg-blue-100 text-blue-800"}};return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Team Performance"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[p.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[p.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[e.utilizationRate.toFixed(1),"%"]}),p.jsx("p",{className:"text-sm text-gray-600",children:"Utilization Rate"})]}),p.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[p.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.productivityScore.toFixed(1)}),p.jsx("p",{className:"text-sm text-gray-600",children:"Productivity Score"})]})]}),t&&e.members&&p.jsxs("div",{children:[p.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Team Members"}),p.jsx("div",{className:"space-y-3",children:e.members.slice(0,10).map(e=>p.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),p.jsx("p",{className:"text-xs text-gray-500",children:e.role})]}),p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsxs("span",{className:"text-sm text-gray-600",children:[e.hoursWorked,"h"]}),p.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s(e.status)}`,children:e.status})]})]},e.id))})]})]})},Le=({risks:e,detailed:t=!1})=>{if(!e)return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Risk Assessment"}),p.jsx("div",{className:"text-center py-8 text-gray-500",children:p.jsx("p",{children:"No risk data available"})})]});const s=e=>e>=7?"bg-red-100 text-red-800 border-red-200":e>=4?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-green-100 text-green-800 border-green-200";return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Risk Assessment"}),p.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${s(e.averageRiskScore)}`,children:[(n=e.averageRiskScore,n>=7?"High":n>=4?"Medium":"Low")," Risk"]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[p.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[p.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.averageRiskScore.toFixed(1)}),p.jsx("p",{className:"text-xs text-gray-600",children:"Average Risk Score"})]}),p.jsxs("div",{className:"text-center p-3 bg-red-50 rounded",children:[p.jsx("p",{className:"text-xl font-bold text-red-600",children:e.highPriorityCount}),p.jsx("p",{className:"text-xs text-gray-600",children:"High Priority Risks"})]})]}),t&&e.risks&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Active Risks"}),e.risks.slice(0,5).map(e=>p.jsxs("div",{className:`p-3 border rounded ${s(e.severity)}`,children:[p.jsxs("div",{className:"flex items-center justify-between mb-1",children:[p.jsx("h5",{className:"text-sm font-medium",children:e.title}),p.jsxs("span",{className:"text-xs font-medium",children:[e.severity,"/10"]})]}),p.jsx("p",{className:"text-xs opacity-80",children:e.description})]},e.id))]})]});var n},He=({activities:e=[]})=>{const t=e=>{switch(e){case"project":return"🏗️";case"invoice":return"💰";case"task":return"✅";case"user":return"👤";default:return"📝"}},s=e=>{const t=new Date,s=new Date(e),n=t.getTime()-s.getTime(),r=Math.floor(n/6e4),a=Math.floor(n/36e5),i=Math.floor(n/864e5);return i>0?`${i}d ago`:a>0?`${a}h ago`:r>0?`${r}m ago`:"Just now"};return p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activity"}),p.jsxs("div",{className:"space-y-3",children:[e.slice(0,8).map(e=>p.jsxs("div",{className:"flex items-start space-x-3 p-2 hover:bg-gray-50 rounded",children:[p.jsx("span",{className:"text-lg",children:t(e.type)}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"text-sm text-gray-900",children:e.description}),p.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[p.jsx("span",{className:"text-xs text-gray-500",children:e.user}),p.jsx("span",{className:"text-xs text-gray-400",children:"•"}),p.jsx("span",{className:"text-xs text-gray-500",children:s(e.timestamp)})]})]})]},e.id)),0===e.length&&p.jsx("div",{className:"text-center py-8 text-gray-500",children:p.jsx("p",{children:"No recent activity"})})]})]})},Ue=()=>{const[e,t]=n.useState(null),[s,r]=n.useState(!0);return n.useEffect(()=>{setTimeout(()=>{t({location:"Construction Site",temperature:22,condition:"Partly Cloudy",humidity:65,windSpeed:12,icon:"⛅"}),r(!1)},1e3)},[]),s?p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Weather"}),p.jsxs("div",{className:"animate-pulse space-y-3",children:[p.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]}):e?p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Weather"}),p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"text-4xl mb-2",children:e.icon}),p.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[e.temperature,"°C"]}),p.jsx("div",{className:"text-sm text-gray-600",children:e.condition}),p.jsx("div",{className:"text-xs text-gray-500",children:e.location})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Humidity"}),p.jsxs("div",{className:"text-xs text-gray-600",children:[e.humidity,"%"]})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Wind"}),p.jsxs("div",{className:"text-xs text-gray-600",children:[e.windSpeed," km/h"]})]})]}),p.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded text-center",children:p.jsx("div",{className:"text-xs text-blue-800",children:"Good conditions for construction work"})})]}):p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Weather"}),p.jsx("p",{className:"text-gray-500",children:"Weather data unavailable"})]})},$e=({data:e})=>{const[t,s]=n.useState([]),[r,a]=n.useState(!1);n.useEffect(()=>{e.projects&&e.financials&&e.team&&i()},[e]);const i=async()=>{a(!0);try{const t=`\n        Analyze this construction company data and provide actionable insights:\n        \n        Projects: ${JSON.stringify(e.projects?.slice(0,5))}\n        Financials: ${JSON.stringify(e.financials)}\n        Team: ${JSON.stringify(e.team)}\n        \n        Please provide:\n        1. 3 key performance insights\n        2. 2 potential risks or concerns\n        3. 2 opportunities for improvement\n        4. 1 strategic recommendation\n        \n        Format as JSON with: { type, title, description, priority, action }\n      `,n=await Q.generateContent(t),r=o(n);s(r)}catch(t){s(c())}finally{a(!1)}},o=e=>{try{const t=e.match(/\{[\s\S]*\}/);if(t)return JSON.parse(t[0])}catch(t){}return c()},c=()=>{const t=[];if(e.projects){const s=e.projects.reduce((e,t)=>e+(t.progress||0),0)/e.projects.length;s>80&&t.push({type:"performance",title:"Strong Project Execution",description:`Average project completion at ${s.toFixed(1)}%`,priority:"low",action:"Continue current practices"})}return e.financials?.profitMargin&&e.financials.profitMargin<10&&t.push({type:"risk",title:"Low Profit Margins",description:`Current margin at ${e.financials.profitMargin.toFixed(1)}%`,priority:"high",action:"Review cost structure and pricing"}),e.team?.utilizationRate&&e.team.utilizationRate>90&&t.push({type:"risk",title:"High Team Utilization",description:`Team at ${e.team.utilizationRate.toFixed(1)}% capacity`,priority:"medium",action:"Consider hiring additional resources"}),t},l=e=>{switch(e){case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";case"low":return"border-green-200 bg-green-50";default:return"border-blue-200 bg-blue-50"}};return r?p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[p.jsx(Se,{className:"h-5 w-5 mr-2"}),"AI Insights"]}),p.jsxs("div",{className:"animate-pulse space-y-3",children:[p.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]}):p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[p.jsx(Se,{className:"h-5 w-5 mr-2"}),"AI Insights"]}),p.jsx("button",{onClick:i,className:"text-sm text-blue-600 hover:text-blue-800",children:"Refresh"})]}),p.jsxs("div",{className:"space-y-4",children:[t.map((e,t)=>{const s=(e=>{switch(e){case"performance":return ae;case"risk":return je;case"opportunity":return Se;default:return ue}})(e.type);return p.jsx("div",{className:`p-4 rounded-lg border ${l(e.priority)}`,children:p.jsxs("div",{className:"flex items-start space-x-3",children:[p.jsx(s,{className:"h-5 w-5 text-gray-600 flex-shrink-0 mt-0.5"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),p.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.action&&p.jsxs("p",{className:"text-xs text-gray-500 mt-2 italic",children:["Action: ",e.action]})]}),p.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.priority})]})},t)}),0===t.length&&p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(Se,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),p.jsx("p",{children:"No insights available yet."}),p.jsx("p",{className:"text-sm",children:"Data analysis in progress..."})]})]})]})},We=()=>{const{user:e}=U(),[t,s]=n.useState("overview"),[r,a]=n.useState("last30days"),{projects:i,financials:o,team:c,analytics:l,risks:d,loading:h,error:m,refreshData:u}=((e="last30days")=>{const[t,s]=n.useState({projects:[],financials:null,team:null,analytics:null,risks:null}),[r,a]=n.useState(!0),[i,o]=n.useState(null),c=n.useCallback(async()=>{try{a(!0),o(null);const[t,n,r,i,c]=await Promise.all([_e.getProjects(e),_e.getFinancials(e),_e.getTeamData(e),Me.getDashboardAnalytics(e),_e.getRiskAssessment(e)]);s({projects:t,financials:n,team:r,analytics:i,risks:c})}catch(t){o(t)}finally{a(!1)}},[e]);return n.useEffect(()=>{c()},[c]),{...t,loading:r,error:i,refreshData:c}})(r);(e=>{const[t,s]=n.useState([]),[r,a]=n.useState(!1),[i,o]=n.useState(null),c=n.useCallback(()=>{a(!0)},[]),l=n.useCallback(()=>{a(!1)},[]),d=n.useCallback(e=>{const t={type:e.type||"unknown",data:e.data||{},timestamp:Date.now()};s(e=>[...e,t])},[]);n.useEffect(()=>(e&&c(),()=>{l()}),[e,c,l])})(["projects","invoices","tasks"]);const g=n.useMemo(()=>i&&o?{totalProjects:i.length,activeProjects:i.filter(e=>"active"===e.status).length,totalRevenue:o.totalRevenue||0,profitMargin:o.profitMargin||0,completionRate:i.reduce((e,t)=>e+t.progress,0)/i.length,riskScore:d?.averageRiskScore||0,teamUtilization:c?.utilizationRate||0,overdueInvoices:o.overdueCount||0}:null,[i,o,c,d]),x=[{id:"overview",name:"Overview",icon:ue},{id:"projects",name:"Projects",icon:he},{id:"financials",name:"Financials",icon:we},{id:"team",name:"Team",icon:Ae},{id:"analytics",name:"Analytics",icon:pe},{id:"risks",name:"Risk Management",icon:je}];return h?p.jsx("div",{className:"min-h-screen flex items-center justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):m?p.jsx("div",{className:"min-h-screen flex items-center justify-center",children:p.jsxs("div",{className:"text-red-600 text-center",children:[p.jsx(je,{className:"h-12 w-12 mx-auto mb-4"}),p.jsxs("p",{children:["Error loading dashboard: ",m.message]}),p.jsx("button",{onClick:u,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):p.jsxs("div",{className:"min-h-screen bg-gray-50",children:[p.jsx("div",{className:"bg-white shadow-sm border-b",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"flex justify-between items-center py-6",children:[p.jsxs("div",{children:[p.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",e?.firstName||"User"]}),p.jsx("p",{className:"text-gray-600",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("select",{value:r,onChange:e=>a(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm",children:[p.jsx("option",{value:"last7days",children:"Last 7 Days"}),p.jsx("option",{value:"last30days",children:"Last 30 Days"}),p.jsx("option",{value:"last90days",children:"Last 90 Days"}),p.jsx("option",{value:"lastyear",children:"Last Year"})]}),p.jsxs("button",{className:"relative p-2 text-gray-600 hover:text-gray-900",children:[p.jsx(le,{className:"h-6 w-6"}),d?.highPriorityCount>0&&p.jsx("span",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:d.highPriorityCount})]}),p.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Refresh"})]})]}),p.jsx("div",{className:"border-b border-gray-200",children:p.jsx("nav",{className:"-mb-px flex space-x-8",children:x.map(e=>{const n=e.icon;return p.jsxs("button",{onClick:()=>s(e.id),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm "+(t===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[p.jsx(n,{className:"h-5 w-5 mr-2"}),e.name]},e.id)})})})]})}),p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===t&&p.jsxs("div",{className:"space-y-8",children:[g&&p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[p.jsx(Re,{title:"Active Projects",value:g.activeProjects,total:g.totalProjects,icon:he,trend:"+12%",trendDirection:"up"}),p.jsx(Re,{title:"Total Revenue",value:`$${(g.totalRevenue/1e6).toFixed(1)}M`,icon:we,trend:"+8.2%",trendDirection:"up"}),p.jsx(Re,{title:"Team Utilization",value:`${g.teamUtilization.toFixed(1)}%`,icon:Ae,trend:"-2.1%",trendDirection:"down"}),p.jsx(Re,{title:"Risk Score",value:g.riskScore.toFixed(1),icon:je,trend:"Low",trendDirection:g.riskScore<3?"up":"down"})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[p.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[p.jsx(Oe,{projects:i}),p.jsx(De,{financials:o}),p.jsx(Pe,{team:c})]}),p.jsxs("div",{className:"space-y-8",children:[p.jsx($e,{data:{projects:i,financials:o,team:c}}),p.jsx(Ue,{}),p.jsx(Le,{risks:d}),p.jsx(He,{activities:l?.recentActivities})]})]})]}),"projects"===t&&p.jsx(Oe,{projects:i,detailed:!0}),"financials"===t&&p.jsx(De,{financials:o,detailed:!0}),"team"===t&&p.jsx(Pe,{team:c,detailed:!0}),"analytics"===t&&p.jsx("div",{className:"space-y-8",children:p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Advanced Analytics"})})}),"risks"===t&&p.jsx(Le,{risks:d,detailed:!0})]})]})},Ve=()=>p.jsx("div",{className:"flex items-center justify-center h-32",children:p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),p.jsx("div",{className:"animate-pulse absolute inset-0 rounded-full border-2 border-blue-200"})]})}),Ge=({activeView:e,onViewChange:t})=>p.jsx("nav",{className:"bg-white shadow-sm border-b",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsx("div",{className:"flex space-x-8",children:[{id:"dashboard",name:"Dashboard",icon:"📊"},{id:"projects",name:"Projects",icon:"🏗️"},{id:"invoices",name:"Invoices",icon:"💰"},{id:"team",name:"Team",icon:"👥"},{id:"analytics",name:"Analytics",icon:"📈"},{id:"tools",name:"Tools",icon:"🛠️"},{id:"settings",name:"Settings",icon:"⚙️"}].map(s=>p.jsxs("button",{onClick:()=>t(s.id),className:"flex items-center space-x-2 py-4 px-3 border-b-2 font-medium text-sm transition-colors "+(e===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[p.jsx("span",{className:"text-lg",children:s.icon}),p.jsx("span",{children:s.name})]},s.id))})})}),Fe=()=>{const{user:e,isAuthenticated:t,loading:s,logout:r}=U(),[a,i]=n.useState("dashboard"),[o,c]=n.useState("initializing");return n.useEffect(()=>{X.initializeHealthChecks().then(()=>c("ready")).catch(()=>c("error"))},[]),s||"initializing"===o?p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:p.jsxs("div",{className:"text-center",children:[p.jsx(Ve,{}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing ASAgents Platform..."})]})}):t&&e?p.jsxs("div",{className:"min-h-screen bg-gray-50",children:[p.jsx("header",{className:"bg-white shadow-sm",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex justify-between items-center py-4",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("div",{className:"text-2xl",children:"🏗️"}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"ASAgents Ultimate"}),p.jsx("p",{className:"text-sm text-gray-500",children:"Construction Management Platform"})]})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600",children:["Welcome, ",e?.firstName||e?.email]}),p.jsx("button",{onClick:r,className:"text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"Sign out"})]})]})})}),p.jsx(Ge,{activeView:a,onViewChange:i}),p.jsx("main",{className:"py-8",children:p.jsxs(n.Suspense,{fallback:p.jsx(Ve,{}),children:["dashboard"===a&&p.jsx(We,{}),"projects"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Projects"}),p.jsx("p",{className:"text-gray-600",children:"Enhanced project management interface coming soon..."})]})}),"invoices"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Invoices"}),p.jsx("p",{className:"text-gray-600",children:"Advanced financial management interface coming soon..."})]})}),"team"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Team"}),p.jsx("p",{className:"text-gray-600",children:"Team management and performance tracking coming soon..."})]})}),"analytics"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Analytics"}),p.jsx("p",{className:"text-gray-600",children:"Advanced analytics and reporting coming soon..."})]})}),"tools"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Tools"}),p.jsx("p",{className:"text-gray-600",children:"Construction tools and utilities coming soon..."})]})}),"settings"===a&&p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Settings"}),p.jsx("p",{className:"text-gray-600",children:"System configuration and preferences coming soon..."})]})})]})}),p.jsx(Te,{})]}):p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:p.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-lg",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-4xl mb-4",children:"🏗️"}),p.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"ASAgents Ultimate"}),p.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Advanced Construction Management Platform"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("button",{className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Sign in with Google"}),p.jsx("button",{className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Sign in with GitHub"}),p.jsx("button",{className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Continue with Demo"})]}),p.jsx("div",{className:"text-center text-xs text-gray-500",children:p.jsx("p",{children:"Enterprise-grade security with OAuth2 integration"})})]})})},Be=()=>p.jsx(J,{children:p.jsx($,{children:p.jsx(Fe,{})})});class ze extends l.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){}render(){return this.state.hasError?p.jsxs("div",{className:"p-6",children:[p.jsx("h2",{className:"text-lg font-semibold",children:"Something went wrong."}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Please refresh the page or try again later."})]}):this.props.children}}const Je=document.getElementById("root");if(!Je)throw new Error("Could not find root element to mount to");f.createRoot(Je).render(p.jsx(l.StrictMode,{children:p.jsx(ze,{onError:(e,t)=>{},children:p.jsx(Be,{})})}));
